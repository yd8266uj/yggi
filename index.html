<!DOCTYPE html>
<html>
<body>
<div id="version">-a6</div>
<div id="log"></div>
 
<script>



	function speak(text, callback) {
		var u = new SpeechSynthesisUtterance();
		u.text = text;
		u.lang = 'en-US';
		u.voice = 'Google US English';
	 
		u.onend = function () {
			if (callback) {
				callback();
			}
		};
	 
		u.onerror = function (e) {
			if (callback) {
				callback(e);
			}
		};
	 
		speechSynthesis.speak(u);
	}
 
 

    speak('Let me know when you are ready to begin', function () {
	
		var SpeechRecognition = SpeechRecognition || webkitSpeechRecognition
		var SpeechGrammarList = SpeechGrammarList || webkitSpeechGrammarList
		var SpeechRecognitionEvent = SpeechRecognitionEvent || webkitSpeechRecognitionEvent
		var grammar = '#JSGF V1.0; grammar commands; public <command> = go | pause ;';

		var recognition = new SpeechRecognition();
		var speechRecognitionList = new SpeechGrammarList();
		speechRecognitionList.addFromString(grammar, 1);
		recognition.grammars = speechRecognitionList;
		recognition.continuous = true;
		recognition.lang = 'en-US';
		recognition.interimResults = false;
		recognition.maxAlternatives = 1;
 
		recognition.onresult = function (event) {
			log(event.results[0][0].transcript);
		}
		
		recognition.onspeechend = function() {
			log('stopped');
			recognition.stop();
		}

		recognition.onnomatch = function(event) {
			log('no match');
		}

		recognition.onerror = function(event) {
			log('error: ' + event.error);
		}
	 
		// start listening
		recognition.start();
		log('listening...');
    });

	
	function log(string) {
		var log = document.getElementById('log');
		log.innerHTML = string + '<br>' + log.innerHTML;
	}
</script>
</body>
</html>